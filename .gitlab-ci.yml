image: node:12-alpine

stages:
 - build
 - test
 - deploy

cache:
  paths:
   - node_modules/
   - build/

build:
  stage: build
  script:
   - yarn
   - yarn build

test:
  stage: test
  script:
  - yarn test

deploy:
  stage: deploy
  before_script:
   - npm i -g firebase-tools
  script:
   - firebase use mercadolibreprueba --token 1//05STSpTz4psQtCgYIARAAGAUSNwF-L9IrCnLCqha99sHbpo_M9TjxN_O0hVX_ZeacbWF0uxPC_6sgyThdkJnD2MQlbHvJ7TUry_0
   - firebase deploy --only hosting:mercadolibreprueba -m "Pipe $CI_PIPELINE_ID Build $CI_BUILD_ID @Hash ${CI_COMMIT_SHA:0:7}" --token 1//05STSpTz4psQtCgYIARAAGAUSNwF-L9IrCnLCqha99sHbpo_M9TjxN_O0hVX_ZeacbWF0uxPC_6sgyThdkJnD2MQlbHvJ7TUry_0
  only:
   - develop